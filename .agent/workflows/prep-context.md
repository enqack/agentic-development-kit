---
description: Load and verify workspace context
operating_mode: audit-only
artifacts_required:
  - artifacts/intent/project_intent.md
  - artifacts/logs/context_manifest.md
---

# prep-context

## Precondition

- `artifacts/intent/project_intent.md` exists.

If the precondition is not met:

- **FAIL CLOSED**
- Ask the operator:
  - "What are you trying to produce in this repo (software, book, research notes, something else), and what does 'done' look like for the first milestone?"
- Initiate the `establish-intent` workflow.
- Do **not** continue with any other workflow until intent is established.

## Operating Rules

- No code or configuration modifications are permitted.
- Artifact writes are permitted **only** under `artifacts/**` and **only** as specified by `artifacts_required`.
- This workflow runs strictly in `audit-only` mode.

## Purpose

Load and verify required workspace context before any planning or execution:

- `AGENTS.md` (mandatory)
- `AGENDA.md` (mandatory)
- Relevant files under `docs/` if present and not ignored

If any mandatory context file is missing, **fail closed**.

## Agent Ignore

- MUST respect `.agentsignore` when selecting any additional files to read.
- `.agentsignore` MUST be parseable by `tools/generate_context_manifest.py`.
- If `.agentsignore` is missing, unreadable, or malformed, **fail closed**.

## Required Actions

1. Read all mandatory context files.
2. Read additional context files subject to `.agentsignore` and any read-scope budget.
3. Extract and internalize all enforceable constraints defined in `AGENTS.md`.

## Output: context_manifest.md

Emit `artifacts/logs/context_manifest.md`.

The file MUST be generated by running:

```bash
python3 tools/generate_context_manifest.py
```

Manual creation or editing of this file is prohibited.

### Required Fields

- Timestamp (ISO-8601, UTC)
- Operating mode
- Agent ignore file used
- Files read as context (repo-relative paths)
- Files skipped due to `.agentsignore` (if detectable)
- Any read-scope budget applied (count/bytes) and whether truncation occurred
- **Constraints acknowledged**:
  - A concise list of enforceable rules extracted from `AGENTS.md`

## Mode Compatibility

- This workflow MUST NOT transition into any workflow that performs modifications.
- If the requested next step requires execution or mutation, stop and request the operator to rerun with an appropriate operating mode.

## Prohibitions

- No code changes
- No configuration changes
- No partial artifacts
- No speculative continuation beyond context loading
